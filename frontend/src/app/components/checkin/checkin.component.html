<div class="container">
  
  <div *ngIf="mensagem" 
       class="message"
       [ngClass]="{
         'success': mensagemTipo === 'success',
         'error': mensagemTipo === 'error',
         'info': mensagemTipo === 'info'
       }">
    {{ mensagem }}
  </div>

  <!-- Botões no topo -->
  <div class="top-buttons">
    <button 
      type="button"
      (click)="abrirPopupPessoa()"
    >
      Incluir pessoa
    </button>
    <button 
      type="button"
      (click)="abrirPopupGerenciar()"
    >
      Gerenciar Pessoas
    </button>
  </div>

  <!-- Seção Novo Check-in -->
  <div class="main-card">
    <div class="card-header">
      <h2>Novo check in</h2>
    </div>
    
    <div class="card-content">
      <div class="checkin-grid">
        <div class="form-field required">
          <label>Data/hora de entrada</label>
          <input 
            type="datetime-local" 
            [(ngModel)]="checkin.dataEntrada"
            required
          >
        </div>
        
        <div class="form-field">
          <label>Data/hora de saída</label>
          <input 
            type="datetime-local" 
            [(ngModel)]="checkin.dataSaida"
          >
        </div>
      </div>
      
      <div class="pessoa-veiculo-row">
        <div class="form-field required pessoa-input-field">
          <label>Pessoa</label>
          <div class="search-container">
            <input 
              type="text"
              [(ngModel)]="buscaPessoa"
              (input)="buscarPessoas($event)"
              (focus)="mostrarSugestoes = true"
              (blur)="onBlurBusca()"
              placeholder="Digite o nome ou documento da pessoa"
              required
            >
            <div class="sugestoes-container" *ngIf="mostrarSugestoes && sugestoesPessoas.length > 0">
              <div 
                *ngFor="let pessoa of sugestoesPessoas" 
                class="sugestao-item"
                (click)="selecionarPessoa(pessoa)"
              >
                {{ pessoa.nome }} - {{ pessoa.documento }}
              </div>
            </div>
          </div>
          
          <div class="checkbox-field">
            <input 
              type="checkbox" 
              [(ngModel)]="checkin.adicionalVeiculo"
              id="veiculo"
            >
            <label for="veiculo">Possui veículo</label>
          </div>
        </div>
      </div>
      
      <button 
        (click)="criarCheckin()"
        class="save-button"
      >
        Salvar
      </button>
    </div>
  </div>

  <!-- Seção Consultas -->
  <div class="main-card">
    <div class="card-header">
      <h2>Consultas</h2>
    </div>
    
    <div class="card-content">
      <div class="filters-section">
        <span class="filters-label">Filtrar por:</span>
        <div class="filter-buttons">
          <button
            (click)="buscarCheckinsPresentes()"
            class="filter-button"
            [ngClass]="{'active': filtroAtivo === 'presentes'}"
          >
            Pessoas ainda presentes
          </button>
          <button
            (click)="buscarCheckinsSaidos()"
            class="filter-button"
            [ngClass]="{'active': filtroAtivo === 'saidos'}"
          >
            Pessoas que já deixaram o hotel
          </button>
          <button
            (click)="limparFiltros()"
            class="filter-button clear-filter"
            [ngClass]="{'active': filtroAtivo === 'todos'}"
          >
            Limpar filtros
          </button>
        </div>
      </div>
      
      <div class="consultas-table-container">
        <table class="consultas-table">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Documento</th>
              <th>Valor gasto (R$)</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let checkin of checkins">
              <td>{{ checkin.pessoa?.nome }}</td>
              <td>{{ checkin.pessoa?.documento }}</td>
              <td>{{ checkin.valorGasto | currency:'BRL' }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Paginação -->
      <div class="pagination">
        <button>← Previous</button>
        <button>Next →</button>
      </div>
    </div>
  </div>

  <!-- Popup para incluir nova pessoa -->
  <app-pessoa-popup 
    *ngIf="mostrarPopupPessoa"
    (pessoaCriada)="onPessoaCriada($event)"
    (fechado)="fecharPopupPessoa()"
  ></app-pessoa-popup>

  <!-- Popup para gerenciar pessoas -->
  <app-gerenciar-pessoas-popup 
    *ngIf="mostrarPopupGerenciar"
    (pessoaAtualizada)="onPessoaAtualizada($event)"
    (pessoaExcluida)="onPessoaExcluida($event)"
    (fechado)="fecharPopupGerenciar()"
  ></app-gerenciar-pessoas-popup>
</div> 